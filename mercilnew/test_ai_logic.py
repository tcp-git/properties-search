from mercilt4_client import MercilClient
import json

# 1. ‡πÉ‡∏™‡πà Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô .env)
API_KEY = "mer-GkI78nqrLJVTlbGDZ0C85PfAxIEIeWvoYPzZpGXEFHAx5ar7"

# 2. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
client = MercilClient(api_key=API_KEY)

# 3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà Filter ‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î)
# ‡πÅ‡∏Ñ‡πà‡πÉ‡∏™‡πà query ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á filters={} ‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏á
query_text = "‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß‡∏´‡∏£‡∏π ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏á ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏•‡∏±‡∏ß‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤"

print(f"üîç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö AI ‡∏î‡πâ‡∏ß‡∏¢ Query: '{query_text}'\n")
response = client.search(query=query_text)

# 4. ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö
if response and "results" in response:
    print(f"‚úÖ ‡πÄ‡∏à‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {len(response['results'])} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n")
    
    for i, item in enumerate(response['results']):
        details = item['asset_details']
        print(f"‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö {i+1}: {details['name']}")
        print(f"   üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤: {details['price']:,.0f} ‡∏ö‡∏≤‡∏ó")
        print(f"   ‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (Final Score): {item['final_score']}")
        print(f"   üß† ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡πÉ‡∏à (Intent Score): {item['intent_score']}")
        print(f"   ü§ñ AI ‡∏™‡∏£‡∏∏‡∏õ: {item['summary']}")
        print("-" * 50)
else:
    print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î")